<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Self-Control of LLM Behaviors by Compressing Suffix Gradient into Prefix Controller">
  <meta name="keywords" content="LLM, Self Control">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Self-Control of LLM Behaviors by Compressing Suffix Gradient into Prefix Controller</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script> -->
  <link rel="icon" type="image/png" href="static/images/selfcontrol_icon.png">

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/explorer-index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <!-- <a class="navbar-item" href="https://github.com/HenryCai11">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a> -->

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://avalonbench.github.io">
            <span class="small-caps">AvalonBench</span>
          </a>
          <!-- <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a> -->
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          
          <!-- <span class="mathvista" style="vertical-align: middle"></span> -->
          <h1 class="title is-1 publication-title">
            <img src="static/images/selfcontrol_icon.png" style="width:1.3em;" alt="Logo" width="200%"/>
            <span class="small-caps">Self-Control</span> of LLM Behaviors by Compressing Suffix Gradient into Prefix Controller</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://github.com/HenryCai11">Min Cai</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://github.com/YCZZZZZZ">Yuchen Zhang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://shichangzh.github.io">Shichang Zhang</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://fanyin3639.github.io">Fan Yin</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://difanzou.github.io">Difan Zou</a><sup>4</sup>,
            </span>
            <span class="author-block">
              <a href="http://www.yisongyue.com">Yisong Yue</a><sup>5</sup>,
            </span>
            <span class="author-block">
              <a href="https://acbull.github.io">Ziniu Hu</a><sup>5</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Shenzhen University,</span>
            <span class="author-block"><sup>2</sup>Rensselaer Polytechnic Institute</span>
            <span class="author-block"><sup>3</sup>University of California, Los Angeles</span>
            <span class="author-block"><sup>4</sup>The University of Hong Kong</span>
            <span class="author-block"><sup>5</sup>California Institute of Technology</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <!-- <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/HenryCai11/LLM-Control"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Colab Link. -->
              <span class="link-block">
                <a href="https://colab.research.google.com/drive/1PqROFczbIKoljYlaF9tUEGSIgTXIn1fY?usp=sharing"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <img src="https://colab.research.google.com/img/colab_favicon_256px.png" alt="Google Colab">
                  </span>
                  <span>Colab</span>
                </a>
              </span>
              <!-- Model. -->
              <span class="link-block">
                <a href="https://huggingface.co/HenryCai1129/selfcontrol-prefix-reasoning-mistral"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="Hugging Face">
                  </span>
                  <span>Model</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- teaser and vedio-->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <div class="content has-text-centered">
          <img src="static/images/teaser.jpg"
          class="interpolation-image"
          alt="Framework of SelfControl"/>
          <p>Scope of <span class="small-caps">SelfControl</span>. Our <span class="small-caps">SelfControl</span> and <span class="small-caps">SelfControl<sub>Prefix</sub></span> are able to control LLM behaviors such as emotion (fearlessness), helpfulness, and reasoning capability. On the right hand side, we show that these different attributes can be composed into a single prefix controller.</p>

      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/framework_vedio.mp4"
                type="video/mp4">
      </video>
        <p>
          <span class="small-caps">SelfControl</span> iteratively controls LLM behaviors using user-defined suffixes.
        </p>
      </div>
      </div>
    </div>
  </div>
</section>

<!-- Abstract -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            In this paper, we propose <span class="small-caps">SelfControl</span>, a novel method utilizing suffix gradients to control the behavior of large language models (LLMs) without explicit human annotations.
          </p>
          <p>
            Given a guideline expressed in suffix string and the model's self-assessment of adherence, <span class="small-caps">SelfControl</span> computes the gradient of this self-judgment with respect to the model's hidden states, directly influencing the auto-regressive generation process towards desired behaviors. To enhance efficiency, we introduce <span class="small-caps">SelfControl<sub>Prefix</sub></span>, a compact module that encapsulates the learned representations from suffix gradients into a Prefix Controller, facilitating inference-time control for various LLM behaviors. Our experiments demonstrate <span class="small-caps">SelfControl</span>'s efficacy across multiple domains, including emotional modulation, ensuring harmlessness, and enhancing complex reasoning. Especially, <span class="small-caps">SelfControl<sub>Prefix</sub></span> enables a plug-and-play control and jointly control multiple attributes, improving model outputs without altering model parameters or increasing inference-time costs.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Methods SelfControl-->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <div class="content has-text-justified">
          <h2 class="title has-text-centered is-3">Method</h2>
          <h2 class="title has-text-centered is-3"></h2>
          <h2 class="subtitle has-text-centered">
            <p><span class="small-caps">SelfControl</span> uses suffix gradients to control model behaviors</p>
          </h2>
          <img src="static/images/suffix_framework.jpg"
          class="interpolation-image"
          alt="Framework of SelfControl"/>
          <p>We begin by sampling an initial response from an auto-regressive language model, and selecting an appropriate suffix string along with a target label to define a control direction. Suffixes can be combined. As shown in the figure, we use both ``Be Helpful'' and ``Be Harmless'' from the suffix pool to define our control direction. Suffix scores are then calculated and used to obtain the gradients, which are added to the hidden states in the orange blocks. These modified hidden states are then used to sample new responses. Steps 3 and 4 form an E-M iteration loop, leading to the final controlled response.</p>
          <!-- SelfControl_prefix -->
          <h2 class="subtitle has-text-centered">
            <p><span class="small-caps">SelfControl<sub>Prefix</sub></span> compresses suffix gradients into Prefix Controllers</p>
          </h2>
          <img src="static/images/prefix.jpg"
          class="interpolation-image"
          alt="Framework of SelfControl"/>
          <p><span class="small-caps">SelfControl<sub>Prefix</sub></span> consists of a LoRA adapter and a learnable prefix prompt. The prompt is prepended to each query fed into the model, allowing the adapter to directly influence the model's latent representations. The latent representations generated from \method are treated as the learning target, and we calculate the mean squared error loss between the latent representations from the desired layers. An example using <span class="small-caps">SelfControl<sub>Prefix</sub></span> is also shown at the bottom of the figure.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Results -->
<section class="section">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3"><p><span class="small-caps">SelfControl</span> Main Results</p></h2>
        <div class="content has-text-justified">
          <p>In this section, we benchmark <span class="small-caps">SelfControl</span> and <span class="small-caps">SelfControl<sub>Prefix</sub></span> on various attributes, including emotions, reducing toxicity, helpfulness and harmlessness (HH) dialogue, and reasoning.</p>
          <div id="results-carousel" class="carousel results-carousel">
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/happiness.png" alt="image name" width="70%"/>
                <!-- <p> Stage 1: Image comprehension self-training for <b>STIC</b>.</p> -->
              </div>
            </div>
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/toxicity.png" alt="image name" width="60%"/>
                <!-- <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p> -->
              </div>
            </div>
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/privacy.png" alt="image name" width="40%"/>
                <!-- <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p> -->
              </div>
            </div>
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/dpo.png" alt="image name" width="50%"/>
                <!-- <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p> -->
              </div>
            </div>
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/gsm8k.png" alt="image name" width="50%"/>
                <!-- <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Analysis -->
<section class="section">
  <div class="container">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3"><p>Analysis and Exploratory Study</p> on <span class="small-caps">SelfControl</span></h2>
        <div class="content has-text-justified">
          <p>We also carry out analysis and exploratory study on <span class="small-caps">SelfControl</span></p>
          <div id="results-carousel" class="carousel results-carousel">
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/norm_study.jpg" alt="image name" width="70%"/>
                <p> Norm study on <span class="small-caps">SelfControl</span>.</p>
              </div>
            </div>
            <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/norm_study.jpg" alt="image name" width="70%"/>
                <p> Norm study on <span class="small-caps">SelfControl</span>.</p>
              </div>
            </div>
            <!-- <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/privacy.png" alt="image name" width="40%"/>
                <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p>
              </div>
            </div> -->
            <!-- <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/dpo.png" alt="image name" width="50%"/>
                <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p>
              </div>
            </div> -->
            <!-- <div class="box m-5">
              <div class="content has-text-centered">
                <img src="static/images/gsm8k.png" alt="image name" width="50%"/>
                <p> Stage 2: Description-infused fine-tuning for <b>STIC</b>.</p>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Examples -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
      <h2 class="title is-3">Examples on <span class="small-caps">SelfControl</span></h2>
    </div>
  </div>
    <div class="columns is-centered has-text-centered">
      <button class="togglebutton" onclick="switchContent('emotion', this)">Emotion</button>
      <button class="togglebutton" onclick="switchContent('harmlessness', this)">Harmlessness</button>
      <button class="togglebutton" onclick="switchContent('fairness', this)">Fairness</button>
      <button class="togglebutton" onclick="switchContent('fact-editing', this)">Fact Editing</button>
      <button class="togglebutton" onclick="switchContent('memorization', this)">Memorization</button>
      </div>
    </div>
  </div>
  
  <div id="emotion" class="togglecontent">
    Content for Emotion.
    <!-- <div class="columns is-centered has-text-centered"></div> -->
    <iframe src="static/plotlys/angry_gens.html" width="1800" height="600"></iframe>
  </div>
  <div id="harmlessness" class="togglecontent">
    Content for Harmlessness.
  </div>
  <div id="fairness" class="togglecontent">
    Content for Fairness.
  </div>
  <div id="fact-editing" class="togglecontent">
    Content for Fact Editing.
  </div>
  <div id="memorization" class="togglecontent">
    Content for Memorization.
  </div>
  <!-- </div> -->
</section>






<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/HenryCai11" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
